var e=Object.assign;import{f as t,u as l}from"./role.137ff37b.js";import{B as o,d as s,r as a,j as n,C as i,t as r,D as m,F as d,G as c,H as u,I as p,b,c as f,e as y,f as v,y as I,i as k}from"./index.45e7214e.js";import"./vendor.5caf421a.js";const w=[{title:"登录名",dataIndex:"username"},{title:"用户编号",dataIndex:"userNo"},{title:"姓名",dataIndex:"realName"},{title:"手机号",dataIndex:"mobile"},{title:"邮箱",dataIndex:"email"},{title:"部门",dataIndex:"dept"},{title:"描述",dataIndex:"note"},{title:"操作",width:"200px",slots:{customRender:"operation"}}];var R=s({name:"system-user",setup(){const s=a({visible:!1,loading:!1,rules:{username:{required:!0,type:"string",message:"请输入用户名",trigger:"blur"}},form:{}}),b=n(null),f=l(s,{C:d,R:c,U:u,D:p},b),y=n([{key:"username",label:"登录名",component:"Input",props:{disabled:i((()=>!!s.form.id))}},{key:"userNo",label:"用户编号",component:"Input"},{key:"realName",label:"姓名",component:"Input"},{key:"password",label:"密码",component:"Input",props:{type:"password"},show:i((()=>!s.form.id))},{key:"confirmPassword",label:"确认密码",component:"Input",props:{type:"password"},show:i((()=>!s.form.id))},{key:"mobile",label:"手机",component:"Input"},{key:"email",label:"邮箱",component:"Input"},{key:"dept",label:"部门",component:"Input"},{key:"note",label:"描述",component:"InputTextArea"}]),v=a({id:null,visible:!1,selectedRowKeys:[],terms:[{key:"roleName",label:"角色名称",component:"Input"}],columns:[{title:"角色名称",dataIndex:"roleName"},{title:"角色描述",dataIndex:"note",ellipsis:!0}],action:t}),I=a({selectedRowKeys:[],onChange:e=>{I.selectedRowKeys=e}});return e(e(e({},r(s)),f),{schemas:y,columns:w,terms:[{key:"username",label:"用户名",component:"Input"},{key:"realName",label:"姓名",component:"Input"}],tableRef:b,action:m,role:v,submitRole:async()=>{var e,t;await(e=v.id,t=I.selectedRowKeys,o.post(`userRole/saveOrUpdate/${e}`,t))&&(v.visible=!1,b.value&&b.value.reload())},setRole:async e=>{v.id=e,v.visible=!0;const t=await(l=e,o.get(`userRole/userId/${l}`));var l;I.selectedRowKeys=t?t.data.map((e=>e.roleId)):[]},rowSelection:I})}});const x=k("编辑"),h=k("选择角色"),C=k("删除");R.render=function(e,t,l,o,s,a){const n=b("a-button"),i=b("lv-table"),r=b("lv-modal-form"),m=b("a-modal");return f(),y("div",null,[v(i,{ref:"tableRef",title:"用户管理",terms:e.terms,columns:e.columns,action:e.action,onCreate:t[1]||(t[1]=t=>e.handle())},{operation:I((({record:t})=>[v(n,{type:"link",size:"small",onClick:l=>e.handle(t.id)},{default:I((()=>[x])),_:2},1032,["onClick"]),v(n,{type:"link",size:"small",onClick:l=>e.setRole(t.id)},{default:I((()=>[h])),_:2},1032,["onClick"]),v(n,{type:"link",size:"small",onClick:l=>e.remove(t.id)},{default:I((()=>[C])),_:2},1032,["onClick"])])),_:1},8,["terms","columns","action"]),v(r,{visible:e.visible,"onUpdate:visible":t[2]||(t[2]=t=>e.visible=t),form:e.form,"onUpdate:form":t[3]||(t[3]=t=>e.form=t),"label-width":90,schemas:e.schemas,rules:e.rules,title:"用户信息",onSubmit:e.submit},null,8,["visible","form","schemas","rules","onSubmit"]),v(m,{visible:e.role.visible,"onUpdate:visible":t[4]||(t[4]=t=>e.role.visible=t),title:"设置角色",width:"780px",onOk:e.submitRole},{default:I((()=>[v(i,{"row-selection":e.rowSelection,action:e.role.action,terms:e.role.terms,columns:e.role.columns},null,8,["row-selection","action","terms","columns"])])),_:1},8,["visible","onOk"])])};export default R;
