var e=Object.assign;import{f as s,u as a,c as t,g as l,a as o,r as i}from"./role.137ff37b.js";import{g as r}from"./menu.8c00c3e9.js";import{B as n,d as c,j as d,r as m,o as u,t as b,b as p,c as k,e as f,f as v,y,i as h}from"./index.45e7214e.js";import"./vendor.5caf421a.js";var C=c({name:"system-role",setup(){const c=d(null),p=m({visible:!1,loading:!1,rules:{roleName:{required:!0,type:"string",message:"请输入角色名称",trigger:"blur"}},form:{}}),k=a(p,{C:t,R:l,U:o,D:i},c),f=d([{key:"roleName",label:"角色名称",component:"Input"},{key:"note",label:"角色描述",component:"InputTextArea"}]);u((()=>{y()}));const v=m({id:null,visible:!1,data:[],checkedKeys:[]}),y=async()=>{const e=await r();v.data=e?e.data:[]};return e(e(e({},b(p)),k),{schemas:f,columns:[{title:"角色名称",dataIndex:"roleName",width:"40%"},{title:"角色描述",dataIndex:"note"},{title:"操作",width:"200px",slots:{customRender:"operation"}}],terms:[{key:"roleName",label:"角色名称",component:"Input"}],tableRef:c,action:s,resource:v,setResource:async e=>{v.id=e,v.visible=!0;const s=await(a=e,n.get(`roleMenu/roleId/${a}`));var a;const t=s?s.data.map((e=>e.resourceId)):[];v.checkedKeys=t},replaceFields:{key:"id"},onCheck:e=>{v.checkedKeys=e},submitRole:async()=>{var e,s;await(e=v.id,s=v.checkedKeys,n.post(`roleMenu/saveOrUpdate/${e}`,s))&&(v.visible=!1)}})}});const g=h("编辑"),K=h("设置菜单"),R=h("删除");C.render=function(e,s,a,t,l,o){const i=p("a-button"),r=p("lv-table"),n=p("lv-modal-form"),c=p("a-tree"),d=p("a-modal");return k(),f("div",null,[v(r,{ref:"tableRef",title:"角色管理",columns:e.columns,terms:e.terms,action:e.action,onCreate:s[1]||(s[1]=s=>e.handle())},{operation:y((({record:s})=>[v(i,{type:"link",size:"small",onClick:a=>e.handle(s.id)},{default:y((()=>[g])),_:2},1032,["onClick"]),v(i,{type:"link",size:"small",onClick:a=>e.setResource(s.id)},{default:y((()=>[K])),_:2},1032,["onClick"]),v(i,{type:"link",size:"small",onClick:a=>e.remove(s.id)},{default:y((()=>[R])),_:2},1032,["onClick"])])),_:1},8,["columns","terms","action"]),v(n,{form:e.form,"onUpdate:form":s[2]||(s[2]=s=>e.form=s),visible:e.visible,"onUpdate:visible":s[3]||(s[3]=s=>e.visible=s),schemas:e.schemas,title:"用户信息",rules:e.rules,column:1,onSubmit:e.submit},null,8,["form","visible","schemas","rules","onSubmit"]),v(d,{visible:e.resource.visible,"onUpdate:visible":s[5]||(s[5]=s=>e.resource.visible=s),title:"资源设置","destroy-on-close":"",onOk:e.submitRole},{default:y((()=>[v(c,{checkedKeys:e.resource.checkedKeys,"onUpdate:checkedKeys":s[4]||(s[4]=s=>e.resource.checkedKeys=s),"replace-fields":e.replaceFields,checkable:"","tree-data":e.resource.data,onCheck:e.onCheck},null,8,["checkedKeys","replace-fields","tree-data","onCheck"])])),_:1},8,["visible","onOk"])])};export default C;
