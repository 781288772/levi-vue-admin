import{j as e,o as t,a,d as n,l as o,c as r,e as s,f as l,g as i,m as d,n as u,h as p,w as c,r as m,q as f,v,s as g,u as b,i as y,x as h,E as w,b as F,y as k}from"./index.ef866087.js";import"./vendor.5caf421a.js";var I=n({name:"Dropdown",props:{title:{type:String,required:!0}},setup(){const n=e(!1),r=e(null),s=(n=>{const o=e(!1),r=e=>{n.value&&(n.value.contains(e.target)?o.value=!1:o.value=!0)};return t((()=>{document.addEventListener("click",r)})),a((()=>{document.removeEventListener("click",r)})),o})(r);return o(s,(()=>{n.value&&s.value&&(n.value=!1)})),{isOpen:n,toggleOpen:()=>{n.value=!n.value},dropdownRef:r}}});const C={ref:"dropdownRef",class:"dropdown",style:{display:"inline-block"}},S={key:0,class:"dropdown-menu",style:{display:"block"}};I.render=function(e,t,a,n,o,c){return r(),s("div",C,[l("a",{href:"#",class:"btn btn-primary my-2 dropdown-toggle",onClick:t[1]||(t[1]=d(((...t)=>e.toggleOpen&&e.toggleOpen(...t)),["prevent"]))},i(e.title),1),e.isOpen?(r(),s("ul",S,[u(e.$slots,"default")])):p("",!0)],512)};var U=n({name:"DropdownItem",props:{disabled:{type:Boolean,default:!1}},setup:()=>({})});const $=c("data-v-8a39383a")(((e,t,a,n,o,l)=>(r(),s("li",{class:["dropdown-item",{"is-disabled":e.disabled}]},[u(e.$slots,"default")],2))));U.render=$,U.__scopeId="data-v-8a39383a";const D={all:R=R||new Map,on:function(e,t){var a=R.get(e);a&&a.push(t)||R.set(e,[t])},off:function(e,t){var a=R.get(e);a&&a.splice(a.indexOf(t)>>>0,1)},emit:function(e,t){(R.get(e)||[]).slice().map((function(e){e(t)})),(R.get("*")||[]).slice().map((function(a){a(e,t)}))}};var R,x=n({name:"Form",emits:["form-submit"],setup(e,{emit:t}){const n=[],o=e=>{e&&n.push(e)};return D.on("form-item-created",o),a((()=>{D.off("form-item-created",o)})),{submitForm:()=>{const e=n.map((e=>e())).every((e=>e));t("form-submit",e)}}}});const O={class:"validate-form-container"},_=l("button",{type:"submit",class:"btn btn-primary"},"提交",-1);x.render=function(e,t,a,n,o,i){return r(),s("div",O,[u(e.$slots,"default"),l("div",{class:"submit-area",onClick:t[1]||(t[1]=d(((...t)=>e.submitForm&&e.submitForm(...t)),["prevent"]))},[u(e.$slots,"submit",{},(()=>[_]))])])};const A=/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;var E=n({name:"FormItem",inheritAttrs:!1,props:{rules:{type:Array},tag:{type:String,default:"input"}},setup(e){const a=m({val:"",error:!1,message:""}),n=()=>{if(e.rules){const t=e.rules.every((e=>{let t=!0;switch(a.message=e.message,e.type){case"required":t=""!==a.val.trim();break;case"email":t=A.test(a.val);break;case"custom":t=!e.validator||e.validator()}return t}));return a.error=!t,t}return!0};return t((()=>{D.emit("form-item-created",n)})),{inputRef:a,validateInput:n}}});const q={class:"validate-input-container pb-3"},j={key:2,class:"invalid-feedback"};E.render=function(e,t,a,n,o,l){return r(),s("div",q,["textarea"!==e.tag?f((r(),s("input",g({key:0,"onUpdate:modelValue":t[1]||(t[1]=t=>e.inputRef.val=t),class:["form-control",{"is-invalid":e.inputRef.error}]},e.$attrs,{onBlur:t[2]||(t[2]=(...t)=>e.validateInput&&e.validateInput(...t))}),null,16)),[[v,e.inputRef.val]]):f((r(),s("textarea",g({key:1,"onUpdate:modelValue":t[3]||(t[3]=t=>e.inputRef.val=t)},e.$attrs,{class:["form-control",{"is-invalid":e.inputRef.error}],onBlur:t[4]||(t[4]=(...t)=>e.validateInput&&e.validateInput(...t))}),null,16)),[[b,e.inputRef.val]]),e.inputRef.error?(r(),s("span",j,i(e.inputRef.message),1)):p("",!0)])};var M=n({props:{type:{type:String,default:"primary"},message:{type:String,required:!0}},setup:()=>({})});const T=l("button",{type:"button",class:"close"},[l("span",{"aria-hidden":"true"},"×")],-1);M.render=function(e,t,a,n,o,l){return r(),s("div",{class:["alert fade show fixed-top mt-3",`alert-${e.type}`]},[y(i(e.message)+" ",1),T],2)};var z=n({props:{action:{type:String,required:!0},beforeUpload:{type:Function},uploaded:{type:Object}},emits:["file-uploaded","file-uploaded-error"],setup(t,a){const n=e(null),o=e(t.uploaded?"success":"ready"),r=e(t.uploaded);return{fileInput:n,triggerUpload:()=>{n.value&&n.value.click()},fileStatus:o,handleFileChange:e=>{const s=e.target;if(s.files){const e=Array.from(s.files);if(t.beforeUpload){if(!t.beforeUpload(e[0]))return}o.value="loading";const l=new FormData;l.append("file",e[0]),w.post(t.action,l,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{o.value="success",r.value=e.data,a.emit("file-uploaded",e.data)})).catch((e=>{o.value="error",a.emit("file-uploaded-error",{error:e})})).finally((()=>{n.value&&(n.value.value="")}))}},uploadedData:r}}});const B={class:"file-upload"},Z=l("button",{class:"btn btn-primary",disabled:""},"正在上传...",-1),L=l("button",{class:"btn btn-primary",disabled:""},"上传成功",-1),V=l("button",{class:"btn btn-primary"},"点击上传",-1);z.render=function(e,t,a,n,o,i){return r(),s("div",B,[l("div",{class:"file-upload-container",onClick:t[1]||(t[1]=d(((...t)=>e.triggerUpload&&e.triggerUpload(...t)),["prevent"]))},["loading"===e.fileStatus?u(e.$slots,"loading",{key:0},(()=>[Z])):"success"===e.fileStatus?u(e.$slots,"uploaded",{key:1,uploadedData:e.uploadedData},(()=>[L])):u(e.$slots,"default",{key:2},(()=>[V]))]),l("input",{ref:"fileInput",class:"file-input d-none",type:"file",onChange:t[2]||(t[2]=(...t)=>e.handleFileChange&&e.handleFileChange(...t))},null,544)])};var G={name:"Test",components:{Dropdown:I,DropdownItem:U,Form:x,FormItem:E,Upload:z},setup:()=>({onFormSubmit:e=>{console.log(e)},showMsg:()=>{((e,t,a=2e3)=>{const n=h(M,{message:e,type:t}),o=document.createElement("div");n.mount(o),document.body.appendChild(o),setTimeout((()=>{n.unmount(o),document.body.removeChild(o)}),a)})("嘿嘿","primary")},handleFileChange:e=>{const t=e.target.files;if(t){const e=t[0],a=new FormData;a.append(e.name,e),w.post("/upload",a,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{console.log(e)}))}},error:e=>{console.log(e)}})};const H=y("1"),J=y("2");G.render=function(e,t,a,n,o,i){const d=F("DropdownItem"),u=F("Dropdown"),p=F("FormItem"),c=F("Form"),m=F("Upload");return r(),s("div",null,[l(u,{title:"dropdown"},{default:k((()=>[l(d,{disabled:""},{default:k((()=>[H])),_:1}),l(d,null,{default:k((()=>[J])),_:1})])),_:1}),l(c,{onFormSubmit:n.onFormSubmit},{default:k((()=>[l(p)])),_:1},8,["onFormSubmit"]),l("button",{onClick:t[1]||(t[1]=(...e)=>n.showMsg&&n.showMsg(...e))},"测试message"),l(m,{action:"/",onFileUploadedError:n.error},null,8,["onFileUploadedError"])])};export default G;
